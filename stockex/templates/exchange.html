<!DOCTYPE html>
<html lang="en">

<head class="crypt-dark">
    <meta charset="UTF-8">
    <title>Crypterio</title>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/icons.css">
    <link rel="stylesheet" href="/static/css/ui.css">
</head>

<body class="crypt-dark">

    <div class="container-fluid">
        <div class="row sm-gutters">

            <div class="col-md-12 col-lg-12 col-xl-12 col-xxl-12">
                <div class="crypt-market-status">
                    <div>
                        <ul class="nav nav-tabs">
                            <li role="presentation"><a href="#history" class="active" data-toggle="tab">market trading</a></li>
                            <li role="presentation"><a href="#market-trading" data-toggle="tab">history</a></li>
                        </ul>
                        <div class="tab-content">
                            <form id="form" method="get">
                            <div role="tabpanel" class="tab-pane active" id="history">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th scope="col">id</th>
                                            <th scope="col">code</th>
                                            <th scope="col">name</th>
                                            <th scope="col">Price</th>
                                            <th scope="col">Price Change</th>
                                            <th scope="col">High</th>
                                            <th scope="col">Low</th>
                                            <th scope="col">Time</th>
                                            <th scope="col">Type</th>
                                            <th scope="col">Quantity</th>
                                            <th style="display: none" id="limit_price_header" scope="col">Limit Price (in â‚¹)</th>
                                            <th scope="col">Buy</th>
                                            <th scope="col">Sell</th>
                                        </tr>
                                    </thead>
                                    <tbody>

                                        <tr>

                                            <td id="id">1</td>
                                            <td id="code"></td>
                                            <td id="companyname"></td>
                                            <td id="price"></td>
                                            <td id="price_change"></td>
                                            <td id="high"></td>
                                            <td id="low"></td>
                                            <td id="time"></td>
                                            <td id="types">
                                                <select id="type" onChange="myFunction(this.options[this.selectedIndex].value)" class="form-control" type="text" name="type" required>
                                                    <option disabled selected >Select</option>
                                                    <option id="market" value="market">Market</option>
                                                    <option id="limit" value="limit">Limit</option>
                                                </select>
                                            </td>
                                            <td id="quantity"><input id="quantityy" class="form-control" type="number" name="quantity" required></td>
                                            <td style="display: none" id="limit_price">
                                                <input id="_limit_price" class="form-control" value="0" type="number" name="limit_price">
                                            </td>
                                            <td id="buy"><div class="menu-green"><button type="submit" name="direction" value="buy"  id="_buy" class="crypt-button-green-full">Buy</button></div></td>
                                            <td id="sell"><div class="menu-red"><button type="submit"  id="_sell" name="direction" value="sell" class="crypt-button-red-full">Sell</button></div></td>

                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                            </form>
                            <div role="tabpanel" class="tab-pane" id="market-trading">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th scope="col">Time</th>
                                            <th scope="col">Amount</th>
                                            <th scope="col">Volume</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>22:35:59</td>
                                            <td>0.0000564</td>
                                            <td>6.6768876</td>
                                        </tr>
                                        <tr>
                                            <td>22:35:59</td>
                                            <td class="crypt-down">0.000056</td>
                                            <td>5.3424984</td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>

<div class="col-lg-12 mt-6" style="padding: 0px 0 0px 0!important;">
				<div>
					<div class="crypt-market-status">
					<div>
					  <!-- Nav tabs -->
					  	<ul class="nav nav-tabs">
					    	<li role="presentation"><a href="#closed-orders"  class="active" data-toggle="tab">Closed Orders</a></li>
					    	<li role="presentation"><a href="#active-orders" data-toggle="tab">Active Orders</a></li>
					  	</ul>

					  <!-- Tab panes -->
					  <div class="tab-content">
					    <div role="tabpanel" class="tab-pane active" id="closed-orders">
					    	<table class="table table-striped">
							  <thead>
							    <tr>
  							      <th scope="col">Time</th>
							      <th scope="col">Buy/sell</th>
							      <th scope="col">Price BTC</th>
							      <th scope="col">Amount BPS</th>
							      <th scope="col">Dealt BPS</th>
							      <th scope="col">Operation</th>
							    </tr>
							  </thead>
							  <tbody>
							    <tr>
							      <th>22:35:59</th>
							      <td class="crypt-up">Buy</td>
							      <td class="crypt-up">0.000056</td>
							      <td class="crypt-up">0.000056</td>
							      <td class="crypt-up">0.0003456</td>
							      <td>5.3424984</td>
							    </tr>
							    <tr>
							      <th>22:35:59</th>
							      <td class="crypt-down">Sell</td>
							      <td class="crypt-down">0.000056</td>
							      <td class="crypt-down">0.000056</td>
							      <td class="crypt-down">0.0003456</td>
							      <td>5.3424984</td>
							    </tr>
							    <tr>
							      <th>22:35:59</th>
							      <td class="crypt-up">Buy</td>
							      <td class="crypt-up">0.000056</td>
							      <td class="crypt-up">0.000056</td>
							      <td class="crypt-up">0.0003456</td>
							      <td>5.3424984</td>
							    </tr>
							    <tr>
							      <th>22:35:59</th>
							      <td class="crypt-down">Sell</td>
							      <td class="crypt-down">0.000056</td>
							      <td class="crypt-down">0.000056</td>
							      <td class="crypt-down">0.0003456</td>
							      <td>5.3424984</td>
							    </tr>
							  </tbody>
							</table>
					    </div>
					    <div role="tabpanel" class="tab-pane" id="active-orders">
					    	<table class="table table-striped">
							  <thead>
							    <tr>
							      <th scope="col">Time</th>
							      <th scope="col">Buy/sell</th>
							      <th scope="col">Price BTC</th>
							      <th scope="col">Amount BPS</th>
							      <th scope="col">Dealt BPS</th>
							      <th scope="col">Operation</th>
							    </tr>
							  </thead>
							</table>
							<div class="no-orders text-center">
								<img src="/static/images/empty.png" alt="no-orders">
							</div>
					    </div>
					    <div role="tabpanel" class="tab-pane" id="balance">
					    	<table class="table table-striped">
							  <thead>
							    <tr>
							      <th scope="col">Currency</th>
							      <th scope="col">Amount</th>
							      <th scope="col">Volume</th>
							    </tr>
							  </thead>
							  <tbody>
							    <tr>
							      <th>BTC</th>
							      <td>0.0000564</td>
							      <td>6.6768876</td>
							    </tr>
							  </tbody>
							</table>
					    </div>
					  </div>

					</div>
				</div>
				</div>
			</div>
		</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


	<script src="/static/amc/core.js"></script>
	<script src="/static/amc/charts.js"></script>
	<script src="/static/amc/dark.js"></script>
	<script src="/static/amc/animated.js"></script>
	<script src="/static/js/jquery.js"></script>
	<script src="/static/js/popper.min.js"></script>
	<script src="/static/bootstrap/js/bootstrap.bundle.js"></script>
	<script src="/static/bootstrap/js/bootstrap.js"></script>
	<script src="/static/js/main.js"></script>
	<script src="/static/js/amc.js"></script>
	<script src="https://s3.tradingview.com/tv.js"></script>
    <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>

    <script>

        (function getStocks() {
    $.ajax({
            type: "GET",
            url: "{% url 'data_gateway' %}",
            success: function (data) {
                $('#code').text(data.data.symbol)
                $('#companyname').text(data.data.companyName)
                var c = data.data.pChange
                if (c<0){
                    $('#price_change').addClass("crypt-down").text(c)
                    $('#price').text(data.data.lastPrice).addClass("crypt-down")
                }
                else {
                    $('#price_change').addClass("crypt-up").text(c)
                    $('#price').text(data.data.lastPrice).addClass("crypt-up")
                }
                $('#high').text(data.data.dayHigh)
                $('#low').text(data.data.dayLow)
                $('#time').text(data.data.timestamp)
                // here you can get data from backend and do changes like
                // changing color by the data coming from your view.
            }
        }).then(function() {           // on completion, restart
       setTimeout(getStocks, 30000);  // function refers to itself
    });
})();
    </script>

<script>
$(document).on('submit', '#form',function(e){
    {#e.preventDefault();#}
    var val = $("input[type=submit][clicked=true]").val();
    var direction = $(document.activeElement).val();
    $.ajax({
        type:'GET',
        url:'{% url "order_gateway" %}',
        data:{
            {#tif:document.getElementById("tif").value,#}
            type:document.getElementById("type").value,
            quantity:document.getElementById("quantityy").value,
            {# For buy/sell button #}
            direction:direction,
            limit_price:document.getElementById("_limit_price").value,
            id: document.getElementById("id").innerHTML,
            code:document.getElementById("code").innerHTML,
            timestamp:document.getElementById("time").innerHTML,
            action: 'GET'
        },
        success:function(data){
            alert(data)
        },
        error : function(xhr,errmsg,err) {
        console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
    }
    });
});
</script>
    <script>
        function myFunction(chosen) {
          if(chosen === 'limit'){
              document.getElementById("limit_price").style.display = 'block';
              document.getElementById("limit_price_header").style.display = 'block';
              document.getElementById("_limit_price").required = true;
          }
          else{
              document.getElementById("limit_price").style.display = 'none';
              document.getElementById("limit_price_header").style.display = 'none';
          }
        }

    </script>
</body>
</html>